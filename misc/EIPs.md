## EIP Quick Reference for Auditing

| **EIP / ERC**       | **Purpose**                         | **Key Functions / Concepts**                                      | **Common Vulnerabilities & Audit Checks**                                                                           | **Exam Traps**                                                       |
| ------------------- | ----------------------------------- | ----------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------- |
| **EIP-20 (ERC-20)** | Fungible token standard             | `transfer`, `transferFrom`, `approve`, `allowance`                | Missing return values, integer overflows (pre-0.8), reentrancy in callbacks, approval race condition (double spend) | Approve to non-zero before changing allowance; missing `emit` events |
| **EIP-721**         | Non-fungible token standard         | `ownerOf`, `transferFrom`, `safeTransferFrom`, `onERC721Received` | Unsafe transfer without `safe` checks, reentrancy via hooks, metadata storage issues                                | Forgetting to implement `supportsInterface` correctly                |
| **EIP-1155**        | Multi-token standard                | `safeTransferFrom`, `safeBatchTransferFrom`                       | Reentrancy in batch transfer hooks, type confusion in token IDs                                                     | Forgetting batch acceptance check                                    |
| **EIP-4626**        | Tokenized Vault Standard            | `deposit`, `mint`, `withdraw`, `redeem`                           | Incorrect share/asset conversion, precision loss, flash-loan deposit exploits                                       | Missing preview functions or using stale balances                    |
| **EIP-191**         | Ethereum Signed Message Prefix      | `\x19Ethereum Signed Message:\n`                                  | Replay attacks if missing prefix                                                                                    | Confusing with EIP-712 or forgetting length in prefix                |
| **EIP-712**         | Typed structured data signing       | Domain separator, typed data hash                                 | Replay across chains if no `chainId`, struct hash collisions                                                        | Mixing `abi.encode` and `abi.encodePacked` wrongly                   |
| **EIP-1271**        | Contract-based signature validation | `isValidSignature(bytes,bytes)`                                   | Returning wrong magic value, unsafe external call in validation                                                     | Misinterpreting return type                                          |
| **EIP-1967**        | Proxy storage slots                 | `_IMPLEMENTATION_SLOT` constant                                   | Storage slot collision with logic contract, unsafe upgrade paths                                                    | Using regular storage vars instead of specific slot                  |
| **EIP-1822 (UUPS)** | Upgradeable proxy                   | `upgradeTo`, `proxiableUUID`                                      | Missing access control, selfdestruct of logic contract                                                              | Forgetting to disable initializer                                    |
| **EIP-2535**        | Diamond Standard                    | Multiple facets, selector mapping                                 | Misrouting function selectors, storage collisions                                                                   | Failing to protect facet cuts                                        |
| **EIP-2771**        | Meta-transactions                   | Trusted forwarder pattern                                         | Trusting unverified forwarder, replay if nonce not tracked                                                          | Forgetting to override `_msgSender()`                                |
| **EIP-2612**        | ERC-20 `permit` gasless approvals   | `permit(address,address,uint256,uint256,uint8,bytes32,bytes32)`   | Missing signature expiry check, replay without nonce increment                                                      | Mixing `v`, `r`, `s` ordering                                        |
| **EIP-3009**        | ERC-20 `transferWithAuthorization`  | `transferWithAuthorization`                                       | Nonce reuse, missing expiry                                                                                         | Confusing with EIP-2612                                              |
| **EIP-165**         | Interface detection                 | `supportsInterface(bytes4)`                                       | Wrong interface ID calculation                                                                                      | Forgetting XOR reduction of function selectors                       |
| **EIP-4337**        | Account abstraction                 | `handleOps`, entry point contract                                 | Gas griefing, reentrancy, miscalculated deposits                                                                    | Ignoring paymaster validation                                        |
